<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Profile Management</title>

    <!--<link rel="stylesheet" type="text/css" href="stylesheets/resetHome.css" />-->
    <!--<link rel="stylesheet" type="text/css" href="stylesheets/home.css" />-->
    <!--<link rel="stylesheet" type="text/css" href="stylesheets/style-responsive.css" />-->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet"  type="text/css" href="/stylesheets/courseTable.css">
</head>

<body style="padding-top: 10rem">

<nav class="navbar navbar-default navbar-fixed-top navmain" >
    <div class="container" >
        <a href="/" class="CTtitle"><h1>Class Transcribe</h1></a>
    </div>
</nav>

<div class="container">



    <div class="row">
        <div class="col-md-2">
        </div>
        <div class="col-md-10">
            <!--Select a term:-->
            <select id="school-term" value="All" hidden="yes">
            <!--<select id="school-term" value="All">/-->
            </select>

            <form action="/manage-classes/search" id="search-form" method="GET" class="pull-right">
                <input type='input' id='search-input' name="q">
                <input type='submit' id='search-button' value='Search' class="btn">
            </form>
        </div>
            <!--<form id="search-form" method="GET" class="pull-right">-->
                <!--<input type='text' id='search-input'>-->
                <!--<input type='submit' id='search-button' value='Search' class="btn">-->
            <!--</form>-->

            <!--<div class="search-container">-->
                <!--<input class="search-box" type="text" placeholder="Enter a {{className}} term (eg. {{exampleTerm}})"></input>-->
            <!--</div>-->
            <!--<div class="search-results-container"></div>-->

            <!--&lt;!&ndash;<div class="course-list-container">&ndash;&gt;-->
                <!--&lt;!&ndash;<select class="video-selector"></select>&ndash;&gt;-->
            <!--&lt;!&ndash;</div>&ndash;&gt;-->



            <!--{{#className}}-->
                <!--<script src="/javascripts/data/videos/{{className}}.js"></script>-->
            <!--{{/className}}-->

            <!--<script>-->
                <!--var piwikServer = "{{piwikServer}}";-->
                <!--className = "{{className}}";-->
            <!--</script>-->
            <!--<script src="/javascripts/libraries/header.js"></script>-->

            <!--<script src="/javascripts/controllers/search.js"></script>-->
            <!--<script src="/javascripts/data/captions/{{className}}.js"></script>-->

            <!--<script>-->
                <!--(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){-->
                    <!--(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),-->
                        <!--m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)-->
                <!--})(window,document,'script','//www.google-analytics.com/analytics.js','ga');-->

                <!--ga('create', 'UA-29520426-2', 'auto');-->
                <!--ga('send', 'pageview');-->
            <!--</script>-->
    </div>


    <div style="margin:3rem">
    </div>


    <div class="row">

        <div class="col-lg-2  filterbox">
            <div>
                <h5>Filter By Terms</h5>
                <div id="termFilterData">
                    {{{termfilterdata}}}
                </div>
            </div>

            <div>
                <h5>Filter By Subject</h5>
                <div id="subjectFilterData">
                    {{{subjectfilterdata}}}
                </div>
            </div>

        </div>
        <div class="col-lg-10">
            <table class="table table-sm" id="course-list">
                <!--<tr id="#header">-->
                    <!--<th>University</th>-->
                    <!--<th>Subject</th>-->
                    <!--<th>Course Number</th>-->
                    <!--<th>Section Number</th>-->
                    <!--<th>Course Name</th>-->
                    <!--<th>Course Instructor</th>-->
                    <!--<th>Course Descruption</th>-->
                    <!--<th>Action</th>-->
                <!--</tr>-->
                {{{tabledata}}}
            </table>

            {{{createform}}}
        </div>
    </div>


    <!--<section>-->
        <!--<div class="row">-->
            <!--<h3>Create a new course</h3>-->
        <!--</div>-->
        <!--<form id="creation-form" method="POST">-->
            <!--<div class="row">-->
                <!--<div class="col-md-3">-->
                    <!--<label>Subject</label>-->
                    <!--<input type="text" class="form-control" id="fminput1" placeholder="Example input" value="CS" name="Subject">-->
                    <!--<label>Course Number</label>-->
                    <!--<input type="text" class="form-control" id="fminput2" placeholder="Another input" name="ClassNumber">-->

                <!--</div>-->
                <!--<div class="col-md-3">-->
                    <!--<label>Class Name</label>-->
                    <!--<input type="text" class="form-control" id="fminput3" placeholder="Example input" name="ClassName">-->
                    <!--<label>Instructor</label>-->
                    <!--<input type="text" class="form-control" id="fminput4" placeholder="Example input" name="Instructor">-->
                <!--</div>-->
                <!--<div class="col-md-2">-->
                    <!--<label>Section Number</label>-->
                    <!--<input type="text" class="form-control" id="fminput5" placeholder="Example input" name="SectionNumber">-->
                    <!--<label>University</label>-->
                    <!--<input type="text" class="form-control" id="fminput6" placeholder="Example input" name="University">-->
                <!--</div>-->
            <!--</div>-->

            <!--<div class="row">-->
                <!--<div class="col-md-8">-->
                    <!--<label>Course Description</label>-->
                    <!--<input type="text" class="form-control" id="fminput7" placeholder="Example input" name="ClassDescription">-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="row">-->
                <!--<div class="col-md-3">-->
                    <!--<button type="submit" class="btn btn-primary" id="subbtn">Create Class</button>-->
                <!--</div>-->
            <!--</div>-->
        <!--</form>-->

    <!--</section>-->



    <!--<section>-->
        <!--Classes to add:-->
        <!--<ul id="cart">-->
            <!--<li>1</li>-->
            <!--<li>2</li>-->
        <!--</ul>-->
    <!--</section>-->




</div>


<section class="contact" id="contact">
    <h1>Contact</h1>
    <hr/>

    <div class="content">

        <div class="contact-text">

            Please DON'T use
            the following e-mail address<br/><br/>

            e-mail: <strong>classTranscribe@gmail.com</strong>

        </div>


    </div>

</section>


<section class="footer">

    <div class="margin">

        <div class="menu-footer">

            <a href="#home">Home</a>
            <a href="https://www.facebook.com/classtranscribe">Facebook</a>

        </div>

        <div class="copyright">Â© 2016. All Rights Reserved UIUC</div>

    </div>

</section>



<!--<form action = "/manage-classes/gettest" method = "post" id="testdataform">-->
    <!--<input type="text" name="g1" value="Upvote" />-->
    <!--<button type="submit" name="g2" id="testdatabutton" class="button" value="testvalue">testing data</button>-->
<!--</form>-->

<!--bootstrap grid test -->
<!--<div class="container">-->
    <!--<div class="row">-->
        <!--<div class="col-md-12">-->
            <!--<div class="row">-->
                <!--<div class="col-md-2">-->
                    <!--<a href="">About</a>-->
                <!--</div>-->
                <!--<div class="col-md-6">-->
                    <!--<a href="">Column2</a>-->
                    <!--<button class="whyisclassnotworking">1234</button>-->
                    <!--<button class="whyisclassnotworking">same1234</button>-->
                    <!--<button class="rmbn">placeholder</button>-->
                <!--</div>-->
                <!--<div class="col-md-4">-->
                    <!--<a href="#myModal1" data-toggle="modal">SHARE</a>-->
                <!--</div>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
<!--</div>-->












<!-- Scripts -->

<!--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script> &lt;!&ndash; jQuery &ndash;&gt;-->
<script src="/javascripts/libraries/jquery.parallax.js"></script> <!-- jQuery Parallax -->
<script src="/javascripts/libraries/jquery.nicescroll.js"></script> <!-- jQuery NiceScroll -->
<script src="/javascripts/libraries/jquery.sticky.js"></script> <!-- jQuery Stick Menu -->
<!--<script src="/javascripts/libraries/homeScript.js"></script> &lt;!&ndash; All script &ndash;&gt;-->



<script>
    $( document ).ready(function() {
    });
    // populate school term options
    var schoolTermsList="{{termlist}}".split(",");
    var termSelection = document.getElementById("school-term");
    schoolTermsList.forEach(function(element) {
        var option = document.createElement("option");
        option.text = element;
        option.value = element;
        termSelection.add(option);
    });
    // get information for the default selection
    //getTermInfo();

    // generate html for the selected term
    function getTermInfo(){
        var term = document.getElementById("school-term");

        var selectedTerm = $("#school-term").val();
        //To be removed
        selectedTerm="All"
        console.log(selectedTerm);
        $.ajax({
            url : "/manage-classes/getterminfo",
            type: "GET",
            data: {"term":selectedTerm},
            success: function (data) {
                console.log(data);
                var html = '';
                html+='<tr id="#header">'+
                        '<th hidden="yes">Term</th>'+
                        '<th>University</th>'+
                        '<th>Subject</th>'+
                        '<th>Course Number</th>'+
                        '<th>Section Number</th>'+
                        '<th>Course Name</th>'+
                        '<th>Course Instructor</th>'+
                        '<th>Course Descruption</th>'+
                        '<th>Action</th>'+
                        '</tr>';
                data.forEach(function (c) {
                    html += '<tr>';
                    html += '<td hidden="yes">' + c["Term"] + '</td>';
                    html += '<td>' + c["University"] + '</td>';
                    html += '<td>' + c["Subject"] + '</td>';
                    html += '<td>' + c["ClassNumber"] + '</td>';;
                    html += '<td>' + c["SectionNumber"] + '</td>';
                    html += '<td>' + c["ClassName"] + '</td>';
                    html += '<td>' + c["Instructor"] + '</td>';
                    html += '<td class="tddesc">' + c["ClassDesc"] + '</td>';
//                    html += '<td style="max-width:30rem;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;\n' +
//                            '-webkit-line-clamp: 3;">' + c["ClassDesc"] + '</td>';
//                    html += '<td>' + '<button type="button" class="btn btn-default btn-sm">\n' +
//                            '          <span class="glyphicon glyphicon-plus"></span> Enroll\n' +
//                            '        </button>' +
//                            '<button type="button" class="btn btn-default btn-sm">\n' +
//                            '          <span class="glyphicon glyphicon-minus"></span> Drop\n' +
//                            '        </button>' +
//                            '<button type="button" class="btn btn-default btn-sm rmbn">\n' +
//                            '          <span class="glyphicon glyphicon-remove"></span> Remove \n' +
//                            '        </button>' +
//                            '</td>';
                    html += '<td class="col-md-2">' + '<a class="actionbtn">' +
                            '          <span class="glyphicon glyphicon-plus"></span> Enroll\n' +
                            '        </a>' +
                            '<a class="actionbtn">' +
                            '          <span class="glyphicon glyphicon-minus"></span> Drop\n' +
                            '        </a>' +
                            '<br>'+
                            '<a class="actionbtn">' +
                            '          <span class="glyphicon glyphicon-pencil"></span> Modify\n' +
                            '        </a>' +
                            '<a class="actionbtn rmbtn">' +
                            '          <span class="glyphicon glyphicon-remove"></span> Remove\n' +
                            '        </a>' +
                            '</td>';


                    html += '</tr>';
                    //append created html to the table body:
                    //$('#course-list').append(html);
                });
                $("#course-list").html(html);
            },
            error: function (jXHR, textStatus, errorThrown) {
                //alert(errorThrown);
            }
        });
    }

    // refresh course list on change
    $( "#school-term" ).change(function() {
        getTermInfo();
    });

//    $("#search-form").submit(function(e) {
//        e.preventDefault();
//        var term = document.getElementById("school-term");
//
//        if($("#school-term").val()!='') {
//            //alert($("#creation-form").serialize());
//            $.ajax({
//                url: "/manage-classes/search",
//                type: "GET",
//                //data: {"data":$("#creation-form").serializeArray(),"term":$("#school-term").val()},
//                data: "Search=" + $("#search-input").val(),
//                success: function (data) {
//                    console.log(data)
//                    //$("#course-list").html(data);
//                    $(document).html(data);
//                },
//                error: function (jXHR, textStatus, errorThrown) {
//                    alert(errorThrown);
//                }
//            });
//        }
//    });

        // create new course
    $("#creation-form").submit(function(e) {
        //alert("submit clicked");
        //alert( JSON.stringify($('#creation-form :input'), null, 4));
        //alert(JSON.stringify($('#creation-form').serializeArray(), null, 4));

        e.preventDefault();
        var term = document.getElementById("school-term");
        var newCourse = [];
        $('#creation-form').serializeArray().forEach(function (elem) {
            newCourse.push(elem["value"]);
            //alert(JSON.stringify(elem["value"], null, 4));
        });


        if($("#school-term").val()!='') {
            //alert($("#creation-form").serialize());
            $.ajax({
                url : "/manage-classes/newclass/",
                type: "POST",
                //data: {"data":$("#creation-form").serializeArray(),"term":$("#school-term").val()},
                data: $("#creation-form").serialize()+"&Term="+$( "#school-term" ).val(),
                success: function (data) {
                    console.log(data);
                },
                error: function (jXHR, textStatus, errorThrown) {
                    alert(errorThrown);
                }
            });
            console.log(newCourse);
            // change list display
            $("#course-list").append('<tr>' +
                    '<td>' + newCourse[5] + '</td>'+
                    '<td>' + newCourse[0] + '</td>'+
                    '<td>' + newCourse[1] + '</td>'+
                    '<td>' + newCourse[4] + '</td>'+
                    '<td>' + newCourse[2] + '</td>' +
                    '<td>' + newCourse[3] + '</td>'+
                    '<td style=\"max-width:5rem;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;  \">' + newCourse[6] + '</td>'+
//                    '<td>' + newCourse["University"] + '</td>'+
//                    '<td>' + newCourse["Subject"] + '</td>'+
//                    '<td>' + newCourse["ClassNumber"] + '</td>'+
//                    '<td>' + newCourse["SectionNumber"] + '</td>'+
//                    '<td>' + newCourse["ClassName"] + '</td>' +
//                    '<td>' + newCourse["Instructor"] + '</td>'+
//                    '<td>' + newCourse["ClassDesc"] + '</td>'+
                    '<td>' + '<button class="testremovebutton">action</button>' +
                    '<button type="button" class="close" aria-label="Close">'+
                    '<span aria-hidden="true">&times;</span> </button>' +
                    '</td>' +
                    '</tr>');
        }
    });


    $( "#testdatabutton" ).click(function() {
        //console.log(x);
        var html = "<li>"+"testli"+"</li>";
        $('#cart').append(html);
    });


    $(document).on('click',".actionbtn.rmbtn",function (e) {
//    $(document).on('click',".btn.btn-default.btn-sm.rmbn",function (e) {
        e.preventDefault();
       //console.log($(this).parent().parent());
       //console.log(typeof($(this).parent().parent()));
       // console.log($(this).parent().parent()[0]);
       //console.log(typeof($(this).parent().parent()[0]));
       //console.log(JSON.stringify($(this).parent().parent()[0]));
       console.log("remove button clicked");
       var retd = {}
       for (var d in $(this).parent().parent()[0]){
           retd[d] = d;
       }
       var row = $(this).closest("tr");
        $.ajax({
            url : "/manage-classes/deleteclass/",
            type: "POST",
            //json: JSON.stringify($(this).parent().parent()[0]),
            //data:$(this).parent().parent().text(),
            data:'term='+$("#school-term").val()+'&classinfo='+$(this).closest("tr").find('td').map(function() {
                return $(this).text();
            }).get().join(',,'),
            success: function (data) {
                row.html("");
            },
            error: function (jXHR, textStatus, errorThrown) {
                alert(errorThrown);
            }
        });
    });

    $(document).on('click',".form-check-input",function (e) {
        console.log("filter button clicked");
        var fterm=$("#termFilterData input:checked").map(function(i,e){return e.value;}).get().join(';;');
        var fsubject=$("#subjectFilterData input:checked").map(function(i,e){return e.value;}).get().join(';;');
        $.ajax({
            url : "/manage-classes/applyfilter",
            type: "POST",
            //json: JSON.stringify($(this).parent().parent()[0]),
            //data:$(this).parent().parent().text(),
            data:'termfilter='+fterm+'&subjectfilter='+fsubject,
            success: function (data) {
                $('#course-list').html(data);
            },
            error: function (jXHR, textStatus, errorThrown) {
                alert(errorThrown);
            }
        });
    });








//    $(document).on('click',"tr",function (e) {
//        console.log(e);
//        console.log(this);
//        console.log("remove button clicked");
//    });
</script>

</body>

</html>



